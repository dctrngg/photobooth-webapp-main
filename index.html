<!DOCTYPE html>
<html lang="vi">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes" />
  <title>dctrng's Booth</title>

  <link rel="icon" href="Assets/fish-photobooth/favicon.png" type="image/x-icon" />
  <link rel="stylesheet" href="StyleSheets/home.css" />

  <style>
    /* ================= Overlay Photobooth ================= */
    #photobooth-overlay {
      position: fixed;
      top: 0; left: 0;
      width: 100vw; height: 100vh;
      z-index: 9999;
      background: #000;
      opacity: 1;
      transition: opacity 0.6s ease;
      overflow: hidden;
    }

    #photobooth-iframe {
      width: 100%; height: 100%;
      border: none;
      overflow: auto;
      -webkit-overflow-scrolling: touch;
    }

    /* Nội dung chính ẩn ban đầu */
    .home-container {
      opacity: 0;
      transition: opacity 0.6s ease;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }

    .home-container.visible {
      opacity: 1;
    }

    body {
      overflow: hidden;
    }

  
  </style>
</head>

<body>
  <!-- ================= Overlay Photobooth ================= -->
  <div id="photobooth-overlay">
    <iframe id="photobooth-iframe" src="./dist/index.html" scrolling="yes"></iframe>
  </div>

  <!-- Main Container -->
  <div class="home-container" id="main-content">
    <div class="photobooth-container">
      <div class="photobooth-mock"></div>
      <div class="photostrip-mock"></div>
      <div class="bubbles-mock"></div>
      <div class="fish-mock-1"></div>
      <div class="fish-mock-2"></div>
      <div class="fish-mock-3"></div>
    </div>

    <!-- ================= 2 NÚT: SELECT + MEMORY ================= -->
    <div class="button-container">
      <button id="select-button">Chụp ảnh photobooth</button>
      <button id="memory-button">Khoảnh khắc Teky</button>
    </div>
  </div>

  <!-- Tutorial Modal -->
  <div class="tutorial-modal" id="tutorialModal">
    <div class="modal-content">
      <button class="close-modal" id="closeModal" aria-label="Đóng">×</button>
      <div class="modal-header">
        <h2>Hướng Dẫn Sử Dụng</h2>
      </div>
      <div class="modal-body">
        <div class="tutorial-step">
          <strong>Bước 1: Chọn Chế Độ</strong>
          <span>Chọn Camera để chụp ảnh trực tiếp hoặc Upload để tải ảnh có sẵn</span>
        </div>
        <div class="tutorial-step">
          <strong>Bước 2: Tạo Photo Strip</strong>
          <span>Chụp 2 ảnh hoặc upload 2 ảnh để tạo photo strip của bạn</span>
        </div>
        <div class="tutorial-step">
          <strong>Bước 3: Trang Trí</strong>
          <span>Thêm sticker, điều chỉnh kích thước và xoay để trang trí ảnh</span>
        </div>
        <div class="tutorial-step">
          <strong>Bước 4: Chia Sẻ</strong>
          <span>Tải xuống hoặc tạo QR code để chia sẻ với bạn bè</span>
        </div>
      </div>
      <div class="modal-buttons">
        <button class="modal-btn btn-start" id="startBtn">Bắt Đầu</button>
        <button class="modal-btn btn-skip" id="skipBtn">Bỏ Qua</button>
      </div>
    </div>
  </div>

  <!-- Main JS -->
  <script src="Javascripts/home.js"></script>

  <!-- ================= Iframe → Home Scroll Control ================= -->
  <script>
    window.addEventListener("message", (event) => {
      if (event.data.action === "finished-scroll") {
        const overlay = document.getElementById("photobooth-overlay");
        const mainContent = document.getElementById("main-content");

        overlay.style.opacity = "0";
        setTimeout(() => {
          overlay.style.display = "none";
          document.body.style.overflow = "auto";
        }, 600);

        mainContent.classList.add("visible");

        setTimeout(() => {
          mainContent.scrollIntoView({
            behavior: "smooth",
            block: "center"
          });
        }, 700);
      }
    });
  </script>

  <!-- ================= Modal & Buttons JS (ĐÃ THÊM NÚT MEMORY) ================= -->
  <script>
    document.addEventListener('DOMContentLoaded', function () {
      const modal = document.getElementById('tutorialModal');
      const selectButton = document.getElementById('select-button');
      const memoryButton = document.getElementById('memory-button'); 
      const startBtn = document.getElementById('startBtn');
      const skipBtn = document.getElementById('skipBtn');
      const closeModalBtn = document.getElementById('closeModal');

      // === NÚT SELECT (giữ nguyên) ===
      if (selectButton) {
        const newSelectButton = selectButton.cloneNode(true);
        selectButton.parentNode.replaceChild(newSelectButton, selectButton);

        newSelectButton.addEventListener('click', function (e) {
          e.preventDefault();
          e.stopPropagation();
          if (modal) {
            modal.classList.add('show');
            document.body.style.overflow = 'hidden';
          }
        }, true);
      }

      // === NÚT MEMORY (MỚI) – CHUYỂN THẲNG memory.html ===
      if (memoryButton) {
        memoryButton.addEventListener('click', function () {
          window.location.href = 'memory.html';
        });
      }

      // === Modal Actions ===
      function goToMenu() {
        window.location.href = 'menu.html';
      }

      function closeModal() {
        modal.classList.remove('show');
        document.body.style.overflow = '';
      }

      if (startBtn) startBtn.addEventListener('click', goToMenu);
      if (skipBtn) skipBtn.addEventListener('click', goToMenu);
      if (closeModalBtn) closeModalBtn.addEventListener('click', closeModal);

      if (modal) {
        modal.addEventListener('click', function (e) {
          if (e.target === modal) closeModal();
        });
      }

      document.addEventListener('keydown', function (e) {
        if (e.key === 'Escape' && modal && modal.classList.contains('show')) closeModal();
      });

      let lastTouchEnd = 0;
      document.addEventListener('touchend', function (e) {
        const now = Date.now();
        if (now - lastTouchEnd <= 300) e.preventDefault();
        lastTouchEnd = now;
      }, false);
    });
  </script>
</body>

</html>